"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9571],{34637:function(e,t,r){r.d(t,{Y:function(){return p},Z:function(){return h}});var n=r(59499),a=r(77191),o=r(81719),s=r(87054),i=(r(67294),r(85893));function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=(0,o.ZP)(s.Z)((function(e){return(0,a.Z)(e),{border:"0px",flex:1,backgroundColor:"#535047",borderRadius:"4px","&.Mui-selected, &.Mui-selected:hover":{backgroundColor:"#FFFFFF",borderRadius:"4px !important"},"&.Mui-selected, &.Mui-disabled":{zIndex:100,height:"100%",display:"flex",justifyContent:"center",color:"#70562e",".MuiTypography-subheader1":{},".MuiTypography-secondary14":{}}}})),d=(0,o.ZP)(s.Z)((function(e){var t=e.theme;return{border:"0px",flex:1,color:t.palette.text.muted,borderRadius:"4px","&.Mui-selected, &.Mui-selected:hover":{border:"1px solid ".concat(t.palette.other.standardInputLine),backgroundColor:"#FFFFFF",borderRadius:"4px !important"},"&.Mui-selected, &.Mui-disabled":{zIndex:100,height:"100%",display:"flex",justifyContent:"center",color:t.palette.background.header}}}));function p(e){return(0,i.jsx)(d,c({},e))}function h(e){return(0,i.jsx)(l,c({},e))}},59379:function(e,t,r){r.d(t,{f:function(){return d},Z:function(){return p}});var n=r(59499),a=r(81719),o=r(85390),s=r(85893);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(0,a.ZP)(o.Z)({backgroundColor:"#535047",border:"1px solid rgba(235, 235, 237, 0.12)",padding:"4px"}),l=(0,a.ZP)(o.Z)((function(e){return{backgroundColor:e.theme.palette.background.header,padding:"2px",height:"36px",width:"100%"}}));function d(e){return(0,s.jsx)(l,u({},e))}function p(e){return(0,s.jsx)(c,u({},e))}},99571:function(e,t,r){r.r(t),r.d(t,{WithdrawModal:function(){return Ae}});var n=r(59499),a=r(49501),o=r(23286),s=r(67294),i=r(34220),u=r(8195),c=r(46930),l=r(69125),d=r(25298),p=r(31959),h=r(32993),m=r(90116),f=r(1279);var x=s.forwardRef((function(e,t){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),s.createElement("path",{fillRule:"evenodd",d:"M16.707 10.293a1 1 0 010 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 111.414-1.414L9 14.586V3a1 1 0 012 0v11.586l4.293-4.293a1 1 0 011.414 0z",clipRule:"evenodd"}))})),v=r(30120),y=r(81645),b=r(29630),g=r(75158),w=r(25935),A=r(69331),T=r(30313),O=r(77537),S=r(20301),j=r(16376),C=r(68448),E=r(57609),I=r(31001),R=r(67916),W=r(20644),k=r(94671),D=r(70794),_=function(e,t,r){var n=(0,f.hE)((null===t||void 0===t?void 0:t.underlyingBalance)||"0"),a=(0,f.hE)(r.unborrowedLiquidity),o=D.Z.min(n,a),s=(0,f.hE)("0"),i=e.isInEmode&&e.userEmodeCategoryId===r.eModeCategoryId?r.formattedEModeLiquidationThreshold:r.formattedReserveLiquidationThreshold;if(null!==t&&void 0!==t&&t.usageAsCollateralEnabledOnUser&&"0"!==r.reserveLiquidationThreshold&&"0"!==e.totalBorrowsMarketReferenceCurrency){var u=(0,f.hE)(e.healthFactor).minus("1.01");u.gt("0")&&(s=u.multipliedBy(e.totalBorrowsMarketReferenceCurrency).div(i)),o=D.Z.min(o,s.dividedBy(r.formattedPriceInMarketReferenceCurrency))}return o},P=r(50029),H=r(17674),L=r(87794),M=r.n(L),N=r(75331),B=r(24243),U=r(80854),Z=r(56371),q=r(53670),F=r(89291),Y=r(19419),V=r(74119),G=r(32113),Q=r(39771),z=r(15591),K=r(67489),X=r(85893);function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ee=function(e){var t=e.amountToSwap,r=e.isWrongNetwork,n=e.sx,o=e.poolReserve,i=e.targetReserve,c=e.isMaxSelected,l=e.loading,d=e.blocked,p=e.buildTxFn,h=(0,j.Yh)((function(e){return[e.withdrawAndSwitch,e.currentMarketData,e.jsonRpcProvider,e.account,e.generateApproval,e.estimateGasLimit,e.walletApprovalMethodPreference,e.generateSignatureRequest,e.addTransaction,e.trackEvent]})),m=(0,H.Z)(h,10),f=m[0],x=m[1],v=m[2],y=m[3],b=m[4],g=m[5],w=m[6],A=m[7],T=m[8],S=m[9],C=(0,u.vR)(),I=C.approvalTxState,R=C.mainTxState,W=C.loadingTxns,D=C.setMainTxState,_=C.setTxError,L=C.setGasLimit,J=C.setLoadingTxns,ee=C.setApprovalTxState,te=(0,O.Z)(),re=te.sendTx,ne=te.signTxData,ae=(0,s.useState)(void 0),oe=ae[0],se=ae[1],ie=(0,s.useState)(),ue=ie[0],ce=ie[1],le=(0,Y.n)(),de=le.refetchPoolData,pe=le.refetchIncentiveData,he=le.refetchGhoData,me=(0,s.useMemo)((function(){return void 0!==oe&&-1!==oe&&"0"!==t&&!r&&oe<=Number(t)}),[oe,t,r]),fe=w===G.n.PERMIT,xe=function(){var e=(0,P.Z)(M().mark((function e(){var t,r,n,a,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D($($({},R),{},{loading:!0})),e.next=4,p();case 4:return t=e.sent,r=f({poolReserve:o,targetReserve:i,isMaxSelected:c,amountToSwap:(0,Z.parseUnits)(t.inputAmount,o.decimals).toString(),amountToReceive:(0,Z.parseUnits)(t.outputAmount,i.decimals).toString(),augustus:t.augustus,txCalldata:t.swapCallData,signatureParams:ue}),e.next=8,g(r);case 8:return n=e.sent,e.next=11,re(n);case 11:return a=e.sent,e.next=14,a.wait(1);case 14:q.queryClient.invalidateQueries({queryKey:z.B.pool}),he&&he(),de&&de(),pe&&pe(),D({txHash:a.hash,loading:!1,success:!0}),T(a.hash,{action:N.UQ.withdrawAndSwitch,txState:"success",asset:o.underlyingAsset,amount:(0,Z.parseUnits)(t.inputAmount,o.decimals).toString(),assetName:o.name,outAsset:i.underlyingAsset,outAssetName:i.name,outAmount:(0,Z.parseUnits)(t.outputAmount,i.decimals).toString()}),e.next=28;break;case 22:e.prev=22,e.t0=e.catch(0),s=(0,Q.WG)(e.t0,Q.aD.GAS_ESTIMATION,!1),_(s),D({txHash:void 0,loading:!1}),S(E.vh.TRANSACTION_ERROR,{transactiontype:N.UQ.withdrawAndSwitch,asset:o.underlyingAsset,assetName:o.name,error:e.t0});case 28:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=(0,P.Z)(M().mark((function e(){var r,n,a,s,i,u,c,l,d;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,V.sm)(t,o.decimals),n={user:y,token:o.aTokenAddress,spender:x.addresses.WITHDRAW_SWITCH_ADAPTER||"",amount:r},e.prev=2,!fe){e.next=16;break}return a=Math.floor(Date.now()/1e3+3600).toString(),e.next=7,A($($({},n),{},{deadline:a}));case 7:return s=e.sent,ee($($({},I),{},{loading:!0})),e.next=11,ne(s);case 11:i=e.sent,ce({signature:i,deadline:a,amount:r}),ee({txHash:F.Z,loading:!1,success:!0}),e.next=30;break;case 16:return u=b(n),e.next=19,g(u);case 19:return c=e.sent,ee($($({},I),{},{loading:!0})),e.next=23,re(c);case 23:return l=e.sent,e.next=26,l.wait(1);case 26:ee({txHash:l.hash,loading:!1,success:!0}),T(l.hash,{action:N.UQ.withdrawAndSwitch,txState:"success",asset:o.aTokenAddress,amount:(0,Z.parseUnits)(r,o.decimals).toString(),assetName:"a".concat(o.symbol),spender:x.addresses.WITHDRAW_SWITCH_ADAPTER}),_(void 0),ye(o.aTokenAddress);case 30:e.next=37;break;case 32:e.prev=32,e.t0=e.catch(2),d=(0,Q.WG)(e.t0,Q.aD.GAS_ESTIMATION,!1),_(d),I.success||ee({txHash:void 0,loading:!1});case 37:case"end":return e.stop()}}),e,null,[[2,32]])})));return function(){return e.apply(this,arguments)}}(),ye=(0,s.useCallback)(function(){var e=(0,P.Z)(M().mark((function e(t){var r,n,a;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),r=v(),n=new B.A(r),e.next=5,n.approvedAmount({user:y,token:t,spender:x.addresses.WITHDRAW_SWITCH_ADAPTER||""});case 5:a=e.sent,se(a),J(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[v,y,x.addresses.WITHDRAW_SWITCH_ADAPTER,J]);return(0,s.useEffect)((function(){ye(o.aTokenAddress)}),[ye,o.aTokenAddress]),(0,s.useEffect)((function(){var e=0;e=Number(U.eB[N.UQ.withdrawAndSwitch].recommended),me&&!I.success&&(e+=Number(k.pQ)),L(e.toString())}),[me,I,L]),(0,X.jsx)(K.B,{mainTxState:R,approvalTxState:I,isWrongNetwork:r,preparingTransactions:W,handleAction:xe,requiresAmount:!0,amount:t,handleApproval:function(){return ve()},requiresApproval:me,actionText:(0,X.jsx)(a.cC,{id:"Withdraw and Switch"}),actionInProgressText:(0,X.jsx)(a.cC,{id:"Withdrawing and Switching"}),sx:n,errorParams:{loading:!1,disabled:d||!(null!==I&&void 0!==I&&I.success),content:(0,X.jsx)(a.cC,{id:"Withdraw and Switch"}),handleClick:xe},fetchingData:l,blocked:d,tryPermit:!0})};var te,re=s.forwardRef((function(e,t){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14 5l7 7m0 0l-7 7m7-7H3"}))})),ne=r(41024),ae=r(72667),oe=r(55200),se=function(e){var t=e.txHash,r=e.amount,n=e.symbol,o=e.outAmount,s=e.outSymbol;return(0,X.jsx)(oe.R,{txHash:t,children:(0,X.jsxs)(v.Z,{sx:{mt:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,X.jsx)(b.Z,{children:(0,X.jsx)(a.cC,{id:"You've successfully withdrew & switched tokens."})}),(0,X.jsxs)(v.Z,{sx:{display:"flex",alignItems:"center",gap:2,mt:3},children:[(0,X.jsx)(ae.T1,{sx:{fontSize:"20px"},symbol:n}),(0,X.jsx)(ne.B,{value:Number(r),compact:!0,variant:"main14"}),(0,X.jsx)(b.Z,{variant:"secondary14",children:n}),(0,X.jsx)(y.Z,{sx:{fontSize:"14px"},children:(0,X.jsx)(re,{fontSize:"14px"})}),(0,X.jsx)(ae.T1,{sx:{fontSize:"20px"},symbol:s}),(0,X.jsx)(ne.B,{value:Number(o),variant:"main14"}),(0,X.jsx)(b.Z,{variant:"secondary14",children:s})]})]})})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(te||(te={}));var ie,ue=function(e){var t,r=e.assetsBlockingWithdraw,o=e.poolReserve,s=e.healthFactorAfterWithdraw,c=e.withdrawAmount,l=(0,u.vR)().mainTxState,d=(0,i.HT)().user,p=void 0,h=(0,f.hE)(o.unborrowedLiquidity);l.success||l.txHash||(r.length>0&&!r.includes(o.symbol)?p=te.ZERO_LTV_WITHDRAW_BLOCKED:s.lt("1")&&"0"!==d.totalBorrowsMarketReferenceCurrency?p=te.CAN_NOT_WITHDRAW_THIS_AMOUNT:p||!h.eq("0")&&!(0,f.hE)(c).gt(o.unborrowedLiquidity)||(p=te.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY));var m=(t={},(0,n.Z)(t,te.CAN_NOT_WITHDRAW_THIS_AMOUNT,(0,X.jsx)(a.cC,{id:"You can not withdraw this amount because it will cause collateral call"})),(0,n.Z)(t,te.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY,(0,X.jsx)(a.cC,{id:"These funds have been borrowed and are not available for withdrawal at this time."})),(0,n.Z)(t,te.ZERO_LTV_WITHDRAW_BLOCKED,(0,X.jsx)(a.cC,{id:"Assets with zero LTV ({assetsBlockingWithdraw}) must be withdrawn or disabled as collateral to perform this action",values:{assetsBlockingWithdraw:r}})),t);return{blockingError:p,errorComponent:p?m[p]:null}};function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(ie||(ie={}));var de,pe=function(e){var t=e.poolReserve,r=e.userReserve,n=e.symbol,o=e.isWrongNetwork,l=(0,u.vR)(),d=l.gasLimit,p=l.mainTxState,h=l.txError,D=(0,O.Z)().currentAccount,P=(0,i.HT)(),H=P.user,L=P.reserves,M=(0,c.f)(),N=M.currentNetworkConfig,B=M.currentChainId,U=(0,s.useState)(""),Z=U[0],q=U[1],F=(0,s.useState)(!1),Y=F[0],V=F[1],G=(0,s.useRef)(""),Q=(0,j.Yh)((function(e){return e.trackEvent})),z=(0,s.useState)("0.1"),K=z[0],J=z[1],$=L.filter((function(e){return e.underlyingAsset!==t.underlyingAsset})).map((function(e){return{address:e.underlyingAsset,symbol:e.symbol,iconSymbol:e.iconSymbol}}));$=[].concat((0,m.Z)($.filter((function(e){return"GHO"===e.symbol}))),(0,m.Z)($.filter((function(e){return"GHO"!==e.symbol}))));var te=(0,s.useState)($[0]),re=te[0],ne=te[1],ae="-1"===Z,oe=H.userReservesData.find((function(e){return e.underlyingAsset===re.address})),ie=_(H,r,t),ce=(0,f.hE)((null===r||void 0===r?void 0:r.underlyingBalance)||"0"),de=(0,T.k)({chainId:N.underlyingChainId||B,userAddress:D,swapIn:le(le({},t),{},{amount:G.current}),swapOut:le(le({},oe.reserve),{},{amount:"0"}),max:ae&&ie.eq(ce),skip:p.loading||!1,maxSlippage:Number(K)}),pe=de.inputAmountUSD,he=de.inputAmount,me=de.outputAmount,fe=de.outputAmountUSD,xe=de.error,ve=de.loading,ye=de.buildTxFn,be=ve&&"0"===fe,ge=(0,f.hE)(t.unborrowedLiquidity),we=(0,k.Vc)(H),Ae=ae?ie.toString(10):Z,Te=(0,C.DX)({user:H,userReserve:r,poolReserve:t,withdrawAmount:Ae}),Oe=ue({assetsBlockingWithdraw:we,poolReserve:t,healthFactorAfterWithdraw:Te,withdrawAmount:Ae}),Se=Oe.blockingError,je=Oe.errorComponent,Ce=Te.toNumber()>=1&&Te.toNumber()<1.5&&r.usageAsCollateralEnabledOnUser,Ee=(0,f.hE)(Ae).multipliedBy((null===r||void 0===r?void 0:r.reserve.priceInUSD)||0);return p.success?(0,X.jsx)(se,{txHash:p.txHash,amount:he,symbol:t.isWrappedBaseAsset?N.baseAssetSymbol:t.symbol,outSymbol:re.symbol,outAmount:me}):(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(I.W,{inputTitle:(0,X.jsx)(a.cC,{id:"Withdraw"}),value:Ae,onChange:function(e){var t="-1"===e;G.current=t?ie.toString(10):e,q(e),t&&ie.eq(ce)&&Q(E.vh.MAX_INPUT_SELECTION,{type:"withdraw"})},symbol:n,assets:[{balance:ie.toString(10),symbol:n,iconSymbol:t.isWrappedBaseAsset?N.baseAssetSymbol:t.iconSymbol}],usdValue:Ee.toString(10),isMaxSelected:ae,disabled:p.loading,maxValue:ie.toString(10),balanceText:ge.lt(ce)?(0,X.jsx)(a.cC,{id:"Available"}):(0,X.jsx)(a.cC,{id:"Supply balance"})}),(0,X.jsxs)(v.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,X.jsx)(y.Z,{sx:{fontSize:"18px !important"},children:(0,X.jsx)(x,{})}),(0,X.jsx)(w.B,{loading:be,outputAmountUSD:fe,inputAmountUSD:pe})]}),(0,X.jsx)(I.W,{value:me,onSelect:ne,usdValue:fe,symbol:re.symbol,assets:$,inputTitle:(0,X.jsx)(a.cC,{id:"Receive (est.)"}),balanceText:(0,X.jsx)(a.cC,{id:"Supply balance"}),disableInput:!0,loading:be}),xe&&!be&&(0,X.jsx)(b.Z,{variant:"helperText",color:"error.main",children:xe}),void 0!==Se&&(0,X.jsx)(b.Z,{variant:"helperText",color:"error.main",children:je}),(0,X.jsxs)(W.m6,{gasLimit:d,slippageSelector:(0,X.jsx)(S.n,{selectedSlippage:K,setSlippage:J}),children:[(0,X.jsx)(W.oD,{description:(0,X.jsx)(a.cC,{id:"Remaining supply"}),value:ce.minus(Ae||"0").toString(10),symbol:t.isWrappedBaseAsset?N.baseAssetSymbol:t.symbol}),(0,X.jsx)(W.jz,{visibleHfChange:!!Z,healthFactor:H?H.healthFactor:"-1",futureHealthFactor:Te.toString(10)})]}),h&&(0,X.jsx)(R.Q,{txError:h}),Ce&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(A.v,{severity:"error",sx:{my:6},children:(0,X.jsx)(a.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,X.jsxs)(v.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,X.jsx)(g.Z,{checked:Y,onChange:function(){V(!Y),Q(E.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:Y})},size:"small","data-cy":"risk-checkbox"}),(0,X.jsx)(b.Z,{variant:"description",children:(0,X.jsx)(a.cC,{id:"I acknowledge the risks involved."})})]})]}),(0,X.jsx)(ee,{poolReserve:t,targetReserve:oe.reserve,amountToSwap:he,amountToReceive:me,isMaxSelected:ae&&ie.eq(ce),isWrongNetwork:o,blocked:void 0!==Se||Ce&&!Y,buildTxFn:ye,sx:Ce?{mt:0}:{}})]})},he=r(93608),me=function(e){var t=e.poolReserve,r=e.amountToWithdraw,n=e.poolAddress,o=e.isWrongNetwork,s=e.symbol,i=e.blocked,u=e.sx,c=(0,j.Yh)((function(e){return e.withdraw})),l=(0,F.Q)({tryPermit:!1,handleGetTxns:function(){var e=(0,P.Z)(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c({reserve:n,amount:r,aTokenAddress:t.aTokenAddress}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),skip:!r||0===parseFloat(r)||i,deps:[r,n],eventTxInfo:{amount:r,assetName:t.name,asset:t.underlyingAsset},protocolAction:N.UQ.withdraw}),d=l.action,p=l.loadingTxns,h=l.mainTxState,m=l.approvalTxState,f=l.approval,x=l.requiresApproval;return(0,X.jsx)(K.B,{blocked:i,preparingTransactions:p,approvalTxState:m,mainTxState:h,amount:r,isWrongNetwork:o,requiresAmount:!0,actionInProgressText:(0,X.jsx)(a.cC,{id:"Withdrawing {symbol}",values:{symbol:s}}),actionText:(0,X.jsx)(a.cC,{id:"Withdraw {symbol}",values:{symbol:s}}),handleAction:d,handleApproval:function(){return f([{amount:r,underlyingAsset:n}])},requiresApproval:x,sx:u})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(de||(de={}));var fe,xe=function(e){var t=e.poolReserve,r=e.userReserve,n=e.unwrap,o=e.setUnwrap,l=e.symbol,d=e.isWrongNetwork,p=(0,u.vR)(),h=p.gasLimit,m=p.mainTxState,x=p.txError,y=(0,i.HT)().user,w=(0,c.f)().currentNetworkConfig,T=(0,s.useState)(""),O=T[0],S=T[1],D=(0,s.useState)(""),P=D[0],H=D[1],L=(0,s.useState)(!1),M=L[0],N=L[1],B=(0,s.useRef)(""),Z=(0,j.Yh)((function(e){return e.trackEvent})),q="-1"===O,F=_(y,r,t),Y=(0,f.hE)((null===r||void 0===r?void 0:r.underlyingBalance)||"0"),V=(0,f.hE)(t.unborrowedLiquidity),G=q?F.toString(10):O,Q=(0,k.Vc)(y),z=(0,C.DX)({user:y,userReserve:r,poolReserve:t,withdrawAmount:G}),K=ue({assetsBlockingWithdraw:Q,poolReserve:t,healthFactorAfterWithdraw:z,withdrawAmount:G}),J=K.blockingError,$=K.errorComponent,ee=z.toNumber()>=1&&z.toNumber()<1.5&&r.usageAsCollateralEnabledOnUser,te=(0,f.hE)(G).multipliedBy((null===r||void 0===r?void 0:r.reserve.priceInUSD)||0);return m.success?(0,X.jsx)(he.R,{action:(0,X.jsx)(a.cC,{id:"withdrew"}),amount:B.current,symbol:n&&t.isWrappedBaseAsset?w.baseAssetSymbol:t.symbol}):(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(I.W,{value:G,onChange:function(e){var t="-1"===e;B.current=t?F.toString(10):e,S(e),t&&F.eq(Y)?(Z(E.vh.MAX_INPUT_SELECTION,{type:"withdraw"}),H("-1")):H(F.toString(10))},symbol:l,assets:[{balance:F.toString(10),symbol:l,iconSymbol:n&&t.isWrappedBaseAsset?w.baseAssetSymbol:t.iconSymbol}],usdValue:te.toString(10),isMaxSelected:q,disabled:m.loading,maxValue:F.toString(10),balanceText:V.lt(Y)?(0,X.jsx)(a.cC,{id:"Available"}):(0,X.jsx)(a.cC,{id:"Supply balance"})}),void 0!==J&&(0,X.jsx)(b.Z,{variant:"helperText",color:"error.main",children:$}),t.isWrappedBaseAsset&&(0,X.jsx)(W.Pu,{unwrapped:n,setUnWrapped:o,label:(0,X.jsx)(b.Z,{children:"Unwrap ".concat(t.symbol," (to withdraw ").concat(w.baseAssetSymbol,")")})}),(0,X.jsxs)(W.m6,{gasLimit:h,children:[(0,X.jsx)(W.oD,{description:(0,X.jsx)(a.cC,{id:"Remaining supply"}),value:Y.minus(G||"0").toString(10),symbol:t.isWrappedBaseAsset?w.baseAssetSymbol:t.symbol}),(0,X.jsx)(W.jz,{visibleHfChange:!!O,healthFactor:y?y.healthFactor:"-1",futureHealthFactor:z.toString(10)})]}),x&&(0,X.jsx)(R.Q,{txError:x}),ee&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(A.v,{severity:"error",sx:{my:6},children:(0,X.jsx)(a.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,X.jsxs)(v.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,X.jsx)(g.Z,{checked:M,onChange:function(){N(!M),Z(E.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:M})},size:"small","data-cy":"risk-checkbox"}),(0,X.jsx)(b.Z,{variant:"description",children:(0,X.jsx)(a.cC,{id:"I acknowledge the risks involved."})})]})]}),(0,X.jsx)(me,{poolReserve:t,amountToWithdraw:q?P:G,poolAddress:n&&t.isWrappedBaseAsset?U.hP:t.underlyingAsset,isWrongNetwork:d,symbol:l,blocked:void 0!==J||ee&&!M,sx:ee?{mt:0}:{}})]})},ve=r(34637),ye=r(59379);function be(e){var t,r=e.withdrawType,n=e.setWithdrawType,o=(0,c.f)().currentMarketData,s=(0,j.Yh)((function(e){return e.trackEvent}));return null!==(t=o.enabledFeatures)&&void 0!==t&&t.collateralRepay?(0,X.jsx)(v.Z,{sx:{mb:6},children:(0,X.jsxs)(ye.f,{color:"primary",value:r,exclusive:!0,onChange:function(e,t){return n(t)},children:[(0,X.jsx)(ve.Y,{value:fe.WITHDRAW,disabled:r===fe.WITHDRAW,onClick:function(){return s(E.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw"})},children:(0,X.jsx)(b.Z,{variant:"buttonM",children:(0,X.jsx)(a.cC,{id:"Withdraw"})})}),(0,X.jsx)(ve.Y,{value:fe.WITHDRAWSWITCH,disabled:r===fe.WITHDRAWSWITCH,onClick:function(){return s(E.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw and Switch"})},children:(0,X.jsx)(b.Z,{variant:"buttonM",children:(0,X.jsx)(a.cC,{id:"Withdraw & Switch"})})})]})}):null}function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.WITHDRAW=0]="WITHDRAW",e[e.WITHDRAWSWITCH=1]="WITHDRAWSWITCH"}(fe||(fe={}));var Ae=function(){var e=(0,u.vR)(),t=e.type,r=e.close,n=e.args,m=e.mainTxState,f=(0,s.useState)(!0),x=f[0],v=f[1],y=(0,s.useState)(fe.WITHDRAW),b=y[0],g=y[1],w=(0,c.f)().currentMarketData,A=(0,i.HT)().reserves,T=(0,l.hN)(A),O=d.cr.withdrawAndSwitch(w)&&n.underlyingAsset!==(null===T||void 0===T?void 0:T.underlyingAsset);return(0,X.jsx)(p.P,{open:t===u.w8.Withdraw,setOpen:function(){g(fe.WITHDRAW),r()},children:(0,X.jsx)(h.A,{title:(0,X.jsx)(a.cC,{id:"Withdraw"}),underlyingAsset:n.underlyingAsset,keepWrappedSymbol:!x,requiredPermission:o.g.DEPOSITOR,children:function(e){return(0,X.jsxs)(X.Fragment,{children:[O&&!m.txHash&&(0,X.jsx)(be,{withdrawType:b,setWithdrawType:g}),b===fe.WITHDRAW&&(0,X.jsx)(xe,we(we({},e),{},{unwrap:x,setUnwrap:v})),b===fe.WITHDRAWSWITCH&&(0,X.jsx)(X.Fragment,{children:(0,X.jsx)(pe,we({},e))})]})}})})}},30313:function(e,t,r){r.d(t,{k:function(){return c}});var n=r(50029),a=r(87794),o=r.n(a),s=r(1279),i=r(67294),u=r(74119),c=function(e){var t=e.chainId,r=e.max,a=e.maxSlippage,c=e.swapIn,l=e.swapOut,d=e.userAddress,p=e.skip,h=(0,i.useState)("0"),m=h[0],f=h[1],x=(0,i.useState)("0"),v=x[0],y=x[1],b=(0,i.useState)("0"),g=b[0],w=b[1],A=(0,i.useState)("0"),T=A[0],O=A[1],S=(0,i.useState)(),j=S[0],C=S[1],E=(0,i.useState)(!1),I=E[0],R=E[1],W=(0,i.useState)(""),k=W[0],D=W[1],_=(0,i.useMemo)((function(){return{underlyingAsset:c.underlyingAsset,decimals:c.decimals,supplyAPY:c.supplyAPY,amount:c.amount,variableBorrowAPY:c.variableBorrowAPY}}),[c.amount,c.decimals,c.supplyAPY,c.underlyingAsset,c.variableBorrowAPY]),P=(0,i.useMemo)((function(){return{underlyingAsset:l.underlyingAsset,decimals:l.decimals,supplyAPY:l.supplyAPY,amount:l.amount,variableBorrowAPY:l.variableBorrowAPY}}),[l.amount,l.decimals,l.supplyAPY,l.underlyingAsset,l.variableBorrowAPY]),H=(0,i.useCallback)((function(){return(0,u.F8)(_,P,t,d,r)}),[t,_,P,d,r]);return(0,i.useEffect)((function(){if(!p){var e=function(){var e=(0,n.Z)(o().mark((function e(){var t,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.underlyingAsset&&P.underlyingAsset&&_.amount&&"0"!==_.amount&&!isNaN(+_.amount)){e.next=7;break}return f("0"),w("0"),O("0"),y("0"),C(void 0),e.abrupt("return");case 7:return R(!0),e.prev=8,e.next=11,H();case 11:t=e.sent,D(""),C(t),f((0,s.Fv)(t.srcAmount,t.srcDecimals)),y(t.srcUSD),r=new s.rh(t.destAmount).multipliedBy(1-a/100).toFixed(0),w((0,s.Fv)(r,t.destDecimals)),O(t.destUSD),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(8),console.error(e.t0),n=(0,u.aE)(e.t0.message),D(n);case 26:return e.prev=26,R(!1),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[8,21,26,29]])})));return function(){return e.apply(this,arguments)}}(),t=setTimeout((function(){e()}),400);return function(){clearTimeout(t)}}}),[k,p,_.underlyingAsset,P.underlyingAsset,H,a,_.amount,d,r]),{outputAmount:g,outputAmountUSD:T,inputAmount:m,inputAmountUSD:v,loading:I,error:k,buildTxFn:function(){var e=(0,n.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}throw new Error("Route required to build transaction");case 2:return e.abrupt("return",(0,u.xS)(j,c,l,t,d,a));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}},68448:function(e,t,r){r.d(t,{_S:function(){return s},bU:function(){return i},DX:function(){return u}});var n=r(20854),a=r(1279),o=r(70794);function s(e){var t,r=e.fromAmount,o=e.fromAssetData,s=e.fromAssetUserData,i=e.toAmountAfterSlippage,u=e.toAssetData,c=e.user,l=c.isInEmode&&c.userEmodeCategoryId===o.eModeCategoryId?o.formattedEModeLiquidationThreshold:o.formattedReserveLiquidationThreshold,d="0";s.usageAsCollateralEnabledOnUser&&"0"!==o.reserveLiquidationThreshold&&(d=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(r).multipliedBy(o.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:c.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:l}).toString());var p="0";return(!c.isInIsolationMode&&!u.isIsolated||c.isInIsolationMode&&(null===(t=c.isolatedReserve)||void 0===t?void 0:t.underlyingAsset)===u.underlyingAsset)&&(p=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(i).multipliedBy(u.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:c.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:c.isInEmode&&c.userEmodeCategoryId===u.eModeCategoryId?u.formattedEModeLiquidationThreshold:u.formattedReserveLiquidationThreshold}).toString()),{hfEffectOfFromAmount:d,hfAfterSwap:"-1"===c.healthFactor?(0,a.hE)("-1"):(0,a.hE)(c.healthFactor).plus(p).minus(d)}}var i=function(e){var t=e.user,r=e.amountToReceiveAfterSwap,s=e.amountToSwap,i=e.fromAssetData,u=e.toAssetData,c=e.repayWithUserReserve,l=e.debt,d=t.isInEmode&&t.userEmodeCategoryId===i.eModeCategoryId?i.formattedEModeLiquidationThreshold:i.formattedReserveLiquidationThreshold,p="0";null!==c&&void 0!==c&&c.usageAsCollateralEnabledOnUser&&i.usageAsCollateralEnabled&&(p=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(s).multipliedBy(i.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:t.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:d}).toString());var h=(0,a.hE)(o.Z.min(r,l)).multipliedBy(u.priceInUSD).toString(10),m=(0,a.hE)(t.totalBorrowsUSD).minus(h);m=o.Z.max(m,(0,a.hE)("0"));var f=(0,n.L1)({collateralBalanceMarketReferenceCurrency:t.totalCollateralUSD,borrowBalanceMarketReferenceCurrency:m.toString(10),currentLiquidationThreshold:t.currentLiquidationThreshold}),x="0"!==i.reserveLiquidationThreshold&&null!==c&&void 0!==c&&c.usageAsCollateralEnabledOnUser?(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(s).multipliedBy(i.priceInUSD),borrowBalanceMarketReferenceCurrency:m.toString(10),currentLiquidationThreshold:i.formattedReserveLiquidationThreshold}).toString():"0",v=f.eq(-1)?f:f.minus(x);return{hfEffectOfFromAmount:(0,a.hE)(p),hfAfterSwap:v.isLessThan(0)&&!v.eq(-1)?0:v}},u=function(e){var t=e.user,r=e.userReserve,s=e.poolReserve,i=e.withdrawAmount,u=(0,a.hE)(t.totalCollateralMarketReferenceCurrency),c=t.currentLiquidationThreshold,l=(0,a.hE)(t.healthFactor),d=t.isInEmode&&t.userEmodeCategoryId===s.eModeCategoryId?s.formattedEModeLiquidationThreshold:s.formattedReserveLiquidationThreshold;if(null!==r&&void 0!==r&&r.usageAsCollateralEnabledOnUser&&"0"!==s.reserveLiquidationThreshold){var p=(0,a.hE)(i).multipliedBy(s.formattedPriceInMarketReferenceCurrency);u=u.minus(p),c=(0,a.hE)(t.totalCollateralMarketReferenceCurrency).multipliedBy((0,a.hE)(t.currentLiquidationThreshold)).minus((0,a.hE)(p).multipliedBy(d)).div(u).toFixed(4,o.Z.ROUND_DOWN),l=(0,n.L1)({collateralBalanceMarketReferenceCurrency:u,borrowBalanceMarketReferenceCurrency:t.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:c})}return l}}}]);