"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8592],{1252:function(e,t,r){r.d(t,{O:function(){return a}});var n=r(49501),s=r(85893),a=function(){return(0,s.jsx)(n.cC,{id:"Due to internal stETH mechanics required for rebasing support, it is not possible to perform a collateral switch where stETH is the source token."})}},88592:function(e,t,r){r.r(t),r.d(t,{SwapModal:function(){return se}});var n=r(59499),s=r(49501),a=r(67294),o=r(31959),i=r(8195),l=r(32993);var u=a.forwardRef((function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"}))})),c=r(30120),p=r(81645),d=r(29630),m=r(70794),f=r(25935),x=r(69331),h=r(31001),y=r(20644),g=r(1252),v=r(29946),b=r(30313),w=r(43629),j=r(46930),S=r(77537),A=r(20301),O=r(16376),T=r(94847),D=r(68448),C=r(87385),E=r(34220),P=r(93608),k=r(94671),R=r(99730),L=r(50029),I=r(17674),B=r(4730),F=r(87794),Z=r.n(F),N=r(75331),_=r(80854),U=r(21732),W=r(74119),M=r(67489),Y=r(85893),H=["amountToSwap","amountToReceive","isWrongNetwork","sx","poolReserve","targetReserve","isMaxSelected","useFlashLoan","loading","symbol","blocked","buildTxFn"];function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var z=function(e){var t,r=e.amountToSwap,a=e.amountToReceive,o=e.isWrongNetwork,i=e.sx,l=e.poolReserve,u=e.targetReserve,c=e.isMaxSelected,p=e.useFlashLoan,d=e.loading,m=e.symbol,f=e.blocked,x=e.buildTxFn,h=(0,B.Z)(e,H),y=(0,O.Yh)((function(e){return[e.swapCollateral,e.currentMarketData]})),g=(0,I.Z)(y,2),v=g[0],b=g[1],w=(0,U.P)({protocolAction:N.UQ.swapCollateral,handleGetTxns:function(){var e=(0,L.Z)(Z().mark((function e(t,n){var s;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:return s=e.sent,e.abrupt("return",v({amountToSwap:s.inputAmount,amountToReceive:s.outputAmount,poolReserve:l,targetReserve:u,isWrongNetwork:o,symbol:m,blocked:f,isMaxSelected:c,useFlashLoan:p,swapCallData:s.swapCallData,augustus:s.augustus,signature:t,deadline:n,signedAmount:(0,W.sm)(r,l.decimals)}));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),handleGetApprovalTxns:function(){var e=(0,L.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v({amountToSwap:r,amountToReceive:a,poolReserve:l,targetReserve:u,isWrongNetwork:o,symbol:m,blocked:f,isMaxSelected:c,useFlashLoan:!1,swapCallData:"0x",augustus:_.hP}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),gasLimitRecommendation:_.eB[N.UQ.swapCollateral].limit,skip:d||!r||0===parseFloat(r),spender:null!==(t=b.addresses.SWAP_COLLATERAL_ADAPTER)&&void 0!==t?t:"",deps:[u.symbol,r]}),j=w.approval,S=w.action,A=w.approvalTxState,T=w.mainTxState,D=w.loadingTxns,C=w.requiresApproval;return(0,Y.jsx)(M.B,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({mainTxState:T,approvalTxState:A,isWrongNetwork:o,preparingTransactions:D,handleAction:S,requiresAmount:!0,amount:r,handleApproval:function(){return j({amount:(0,W.sm)(r,l.decimals),underlyingAsset:l.aTokenAddress})},requiresApproval:C,actionText:(0,Y.jsx)(s.cC,{id:"Switch"}),actionInProgressText:(0,Y.jsx)(s.cC,{id:"Switching"}),sx:i,fetchingData:d,errorParams:{loading:!1,disabled:f,content:(0,Y.jsx)(s.cC,{id:"Switch"}),handleClick:S},tryPermit:!0},h))},V=r(1279),G=r(76384),K=r(91655),J=r(41024),Q=r(92391),X=r(72667),$=function(e){var t=e.showHealthFactor,r=e.healthFactor,n=e.healthFactorAfterSwap,a=e.swapSource,o=e.swapTarget,i=e.toAmount,l=e.fromAmount,u=e.loading,d=(0,V.hE)(a.underlyingBalance).minus((0,V.hE)(l)),m=(0,V.hE)(o.underlyingBalance).plus((0,V.hE)(i)),f=(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(K.Z,{variant:"rectangular",height:20,width:100,sx:{borderRadius:"4px"}}),(0,Y.jsx)(K.Z,{variant:"rectangular",height:15,width:80,sx:{borderRadius:"4px",marginTop:"4px"}})]});return(0,Y.jsxs)(Y.Fragment,{children:[n&&(0,Y.jsx)(y.jz,{healthFactor:r,futureHealthFactor:n,visibleHfChange:t,loading:u}),(0,Y.jsx)(y.oD,{description:(0,Y.jsx)(s.cC,{id:"Supply apy"}),value:a.reserve.supplyAPY,futureValue:o.reserve.supplyAPY,percent:!0,loading:u}),(0,Y.jsx)(Q.X,{caption:(0,Y.jsx)(s.cC,{id:"Collateralization"}),captionVariant:"description",mb:4,children:(0,Y.jsx)(c.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-end"},children:u?(0,Y.jsx)(K.Z,{variant:"rectangular",height:20,width:100,sx:{borderRadius:"4px"}}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(y.JV,{collateralType:a.collateralType}),(0,Y.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,Y.jsx)(p.Z,{color:"primary",sx:{fontSize:"14px",mx:1},children:(0,Y.jsx)(G.Z,{})}),(0,Y.jsx)(y.JV,{collateralType:o.collateralType})]})]})})}),(0,Y.jsx)(y.aE,{incentives:a.reserve.aIncentivesData,symbol:a.reserve.symbol,futureIncentives:o.reserve.aIncentivesData,futureSymbol:o.reserve.symbol,loading:u}),(0,Y.jsx)(y.oD,{description:(0,Y.jsx)(s.cC,{id:"Liquidation threshold"}),value:a.reserve.formattedReserveLiquidationThreshold,futureValue:o.reserve.formattedReserveLiquidationThreshold,percent:!0,visibleDecimals:0,loading:u}),(0,Y.jsx)(Q.X,{caption:(0,Y.jsx)(s.cC,{id:"Supply balance after switch"}),captionVariant:"description",mb:4,align:"flex-start",children:(0,Y.jsxs)(c.Z,{sx:{textAlign:"right"},children:[(0,Y.jsx)(c.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:u?f:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,Y.jsx)(X.T1,{symbol:a.reserve.iconSymbol,sx:{mr:2,ml:4,fontSize:"16px"}}),(0,Y.jsx)(J.B,{value:d.toString(),variant:"secondary14",compact:!0})]}),(0,Y.jsx)(J.B,{value:d.multipliedBy((0,V.hE)(a.reserve.priceInUSD)).toString(),variant:"helperText",compact:!0,symbol:"USD",symbolsColor:"text.secondary",color:"text.secondary"})]})}),(0,Y.jsx)(c.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},mt:2,children:u?f:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,Y.jsx)(X.T1,{symbol:o.reserve.iconSymbol,sx:{mr:2,ml:4,fontSize:"16px"}}),(0,Y.jsx)(J.B,{value:m.toString(),variant:"secondary14",compact:!0})]}),(0,Y.jsx)(J.B,{value:m.multipliedBy((0,V.hE)(o.reserve.priceInUSD)).toString(),variant:"helperText",compact:!0,symbol:"USD",symbolsColor:"text.secondary",color:"text.secondary"})]})})]})})]})};function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re=function(e){var t=e.poolReserve,r=e.userReserve,n=e.isWrongNetwork,o=(0,E.HT)(),l=o.reserves,L=o.user,I=o.marketReferencePriceInUsd,B=(0,j.f)(),F=B.currentChainId,Z=B.currentMarket,N=B.currentNetworkConfig,_=(0,S.Z)().currentAccount,U=(0,i.vR)(),W=U.gasLimit,M=U.mainTxState,H=U.txError,q=(0,O.Yh)((function(e){return e.displayGho})),V=l.filter((function(e){return!q({symbol:e.symbol,currentMarket:Z})})).filter((function(e){return e.underlyingAsset!==t.underlyingAsset&&!e.isFrozen})).map((function(e){return{address:e.underlyingAsset,symbol:e.symbol,iconSymbol:e.iconSymbol}})),G=(0,a.useState)(""),K=G[0],J=G[1],Q=(0,a.useRef)(""),X=(0,a.useState)(V[0]),ee=X[0],re=X[1],ne=(0,a.useState)("0.1"),se=ne[0],ae=ne[1],oe=L.userReservesData.find((function(e){return e.underlyingAsset===ee.address})),ie=m.Z.min(r.underlyingBalance,new m.Z(t.availableLiquidity).multipliedBy(.99)).toString(10),le="-1"===K,ue=le?ie:K,ce=(0,b.k)({chainId:N.underlyingChainId||F,userAddress:_,swapIn:te(te({},t),{},{amount:Q.current}),swapOut:te(te({},oe.reserve),{},{amount:"0"}),max:le,skip:M.loading||!1,maxSlippage:Number(se)}),pe=ce.inputAmountUSD,de=ce.inputAmount,me=ce.outputAmount,fe=ce.outputAmountUSD,xe=ce.error,he=ce.loading,ye=ce.buildTxFn,ge=he&&"0"===fe,ve=(0,D._S)({fromAmount:ue,fromAssetData:t,fromAssetUserData:r,user:L,toAmountAfterSlippage:me,toAssetData:oe.reserve}),be=ve.hfAfterSwap,we=ve.hfEffectOfFromAmount,je=(0,k.gK)(L.healthFactor,we),Se=(0,T.x)(oe.reserve.supplyCap,oe.reserve.totalLiquidity),Ae=(0,C.N4)(Se,oe.reserve.formattedPriceInMarketReferenceCurrency,I),Oe=(0,k.Vc)(L),Te=void 0;Oe.length>0&&!Oe.includes(t.symbol)?Te=k.NI.ZERO_LTV_WITHDRAW_BLOCKED:!Se.eq("-1")&&Ae.lt(fe)?Te=k.NI.SUPPLY_CAP_REACHED:!be.eq("-1")&&be.lt("1.01")&&(Te=k.NI.HF_BELOW_ONE);var De=function(){switch(Te){case k.NI.SUPPLY_CAP_REACHED:return(0,Y.jsx)(s.cC,{id:"Supply cap on target reserve reached. Try lowering the amount."});case k.NI.HF_BELOW_ONE:return(0,Y.jsx)(s.cC,{id:"The effects on the health factor would cause liquidation. Try lowering the amount."});case k.NI.ZERO_LTV_WITHDRAW_BLOCKED:return(0,Y.jsx)(s.cC,{id:"Assets with zero LTV ({assetsBlockingWithdraw}) must be withdrawn or disabled as collateral to perform this action",values:{assetsBlockingWithdraw:Oe}});default:return null}};if(M.success)return(0,Y.jsx)(P.R,{action:(0,Y.jsx)(s.cC,{id:"Switched"}),amount:Q.current,symbol:t.symbol});var Ce=L&&"0"!==L.totalBorrowsMarketReferenceCurrency&&"0"!==t.reserveLiquidationThreshold,Ee=(0,w.wD)(oe.reserve).debtCeilingReached,Pe=(0,k.yI)(r,L.totalCollateralUSD,L.isInIsolationMode,Ee),ke=(0,w.wD)(oe.reserve).debtCeilingReached,Re=(0,k.yI)(oe,L.totalCollateralUSD,L.isInIsolationMode,ke);if(le&&Pe===v.z.ISOLATED_ENABLED&&"0"===oe.underlyingBalance&&(Re=oe.reserve.isIsolated?v.z.ISOLATED_ENABLED:v.z.ENABLED),le&&Pe===v.z.ENABLED&&"0"===oe.underlyingBalance&&oe.reserve.isIsolated){var Le=L.userReservesData.filter((function(e){return e.usageAsCollateralEnabledOnUser}));1===Le.length&&Le[0].underlyingAsset===r.underlyingAsset&&(Re=v.z.ISOLATED_ENABLED)}return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(h.W,{value:ue,onChange:function(e){var t="-1"===e;Q.current=t?ie:e,J(e)},usdValue:pe,symbol:t.iconSymbol,assets:[{balance:ie,address:t.underlyingAsset,symbol:t.symbol,iconSymbol:t.iconSymbol}],maxValue:ie,inputTitle:(0,Y.jsx)(s.cC,{id:"Supplied asset amount"}),balanceText:(0,Y.jsx)(s.cC,{id:"Supply balance"}),isMaxSelected:le}),(0,Y.jsxs)(c.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,Y.jsx)(p.Z,{sx:{fontSize:"18px !important"},children:(0,Y.jsx)(u,{})}),(0,Y.jsx)(f.B,{loading:ge,outputAmountUSD:fe,inputAmountUSD:pe})]}),(0,Y.jsx)(h.W,{value:me,onSelect:re,usdValue:fe,symbol:ee.symbol,assets:V,inputTitle:(0,Y.jsx)(s.cC,{id:"Switch to"}),balanceText:(0,Y.jsx)(s.cC,{id:"Supply balance"}),disableInput:!0,loading:ge}),xe&&!ge&&(0,Y.jsx)(d.Z,{variant:"helperText",color:"error.main",children:xe}),!xe&&void 0!==Te&&(0,Y.jsx)(d.Z,{variant:"helperText",color:"error.main",children:(0,Y.jsx)(De,{})}),"stETH"===oe.reserve.symbol&&(0,Y.jsx)(x.v,{severity:"warning",sx:{mt:2,mb:0},children:(0,Y.jsx)(g.O,{})}),(0,Y.jsx)(y.m6,{gasLimit:W,slippageSelector:(0,Y.jsx)(A.n,{selectedSlippage:se,setSlippage:ae}),children:(0,Y.jsx)($,{showHealthFactor:Ce,healthFactor:null===L||void 0===L?void 0:L.healthFactor,healthFactorAfterSwap:be.toString(10),swapSource:te(te({},r),{},{collateralType:Pe}),swapTarget:te(te({},oe),{},{collateralType:Re}),toAmount:me,fromAmount:""===ue?"0":ue,loading:ge})}),H&&(0,Y.jsx)(R.f,{txError:H}),(0,Y.jsx)(z,{isMaxSelected:le,poolReserve:t,amountToSwap:de,amountToReceive:me,isWrongNetwork:n,targetReserve:oe.reserve,symbol:t.symbol,blocked:void 0!==Te||""!==xe||"stETH"===oe.reserve.symbol,useFlashLoan:je,loading:he,buildTxFn:ye})]})};function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var se=function(){var e=(0,i.vR)(),t=e.type,r=e.close,a=e.args;return(0,Y.jsx)(o.P,{open:t===i.w8.Swap,setOpen:r,children:(0,Y.jsx)(l.A,{title:(0,Y.jsx)(s.cC,{id:"Switch"}),underlyingAsset:a.underlyingAsset,children:function(e){return(0,Y.jsx)(re,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e))}})})}},30313:function(e,t,r){r.d(t,{k:function(){return u}});var n=r(50029),s=r(87794),a=r.n(s),o=r(1279),i=r(67294),l=r(74119),u=function(e){var t=e.chainId,r=e.max,s=e.maxSlippage,u=e.swapIn,c=e.swapOut,p=e.userAddress,d=e.skip,m=(0,i.useState)("0"),f=m[0],x=m[1],h=(0,i.useState)("0"),y=h[0],g=h[1],v=(0,i.useState)("0"),b=v[0],w=v[1],j=(0,i.useState)("0"),S=j[0],A=j[1],O=(0,i.useState)(),T=O[0],D=O[1],C=(0,i.useState)(!1),E=C[0],P=C[1],k=(0,i.useState)(""),R=k[0],L=k[1],I=(0,i.useMemo)((function(){return{underlyingAsset:u.underlyingAsset,decimals:u.decimals,supplyAPY:u.supplyAPY,amount:u.amount,variableBorrowAPY:u.variableBorrowAPY}}),[u.amount,u.decimals,u.supplyAPY,u.underlyingAsset,u.variableBorrowAPY]),B=(0,i.useMemo)((function(){return{underlyingAsset:c.underlyingAsset,decimals:c.decimals,supplyAPY:c.supplyAPY,amount:c.amount,variableBorrowAPY:c.variableBorrowAPY}}),[c.amount,c.decimals,c.supplyAPY,c.underlyingAsset,c.variableBorrowAPY]),F=(0,i.useCallback)((function(){return(0,l.F8)(I,B,t,p,r)}),[t,I,B,p,r]);return(0,i.useEffect)((function(){if(!d){var e=function(){var e=(0,n.Z)(a().mark((function e(){var t,r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I.underlyingAsset&&B.underlyingAsset&&I.amount&&"0"!==I.amount&&!isNaN(+I.amount)){e.next=7;break}return x("0"),w("0"),A("0"),g("0"),D(void 0),e.abrupt("return");case 7:return P(!0),e.prev=8,e.next=11,F();case 11:t=e.sent,L(""),D(t),x((0,o.Fv)(t.srcAmount,t.srcDecimals)),g(t.srcUSD),r=new o.rh(t.destAmount).multipliedBy(1-s/100).toFixed(0),w((0,o.Fv)(r,t.destDecimals)),A(t.destUSD),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(8),console.error(e.t0),n=(0,l.aE)(e.t0.message),L(n);case 26:return e.prev=26,P(!1),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[8,21,26,29]])})));return function(){return e.apply(this,arguments)}}(),t=setTimeout((function(){e()}),400);return function(){clearTimeout(t)}}}),[R,d,I.underlyingAsset,B.underlyingAsset,F,s,I.amount,p,r]),{outputAmount:b,outputAmountUSD:S,inputAmount:f,inputAmountUSD:y,loading:E,error:R,buildTxFn:function(){var e=(0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T){e.next=2;break}throw new Error("Route required to build transaction");case 2:return e.abrupt("return",(0,l.xS)(T,u,c,t,p,s));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}},94847:function(e,t,r){r.d(t,{x:function(){return i},I:function(){return l}});var n=r(80854),s=r(1279),a=r(70794),o=r(87385);function i(e,t){return"0"===e?new a.Z(-1):new a.Z(e).minus(t)}function l(e,t,r,l){if(t.isFrozen)return"0";var u=(0,s.hE)(e);return u.gt(0)&&r.toLowerCase()===n.hP.toLowerCase()&&(u=u.minus(l)),"0"!==t.supplyCap&&(u=a.Z.min(u,i(t.supplyCap,t.totalLiquidity))),u.lte(0)?"0":(0,o.$w)(u.toString(10),t.decimals)}},76384:function(e,t,r){var n=r(67294);const s=n.forwardRef((function(e,t){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 8l4 4m0 0l-4 4m4-4H3"}))}));t.Z=s}}]);